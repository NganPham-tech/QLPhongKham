@{
    ViewData["Title"] = "Debug Invoice Create";
}

<h2>Debug Invoice Create Page</h2>

<div class="card">
    <div class="card-header">ViewBag Information</div>
    <div class="card-body">
        <h5>CompletedAppointments:</h5>
        @if (ViewBag.CompletedAppointments == null)
        {
            <p class="text-danger">ViewBag.CompletedAppointments is NULL</p>
        }
        else
        {
            var appointments = (List<QLPhongKham.Models.Appointment>)ViewBag.CompletedAppointments;
            <p class="text-success">Found @appointments.Count appointments</p>
            
            @if (appointments.Any())
            {
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Patient</th>
                            <th>Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var app in appointments)
                        {
                            <tr>
                                <td>@app.AppointmentId</td>
                                <td>@(app.Patient?.FullName ?? "N/A")</td>
                                <td>@app.AppointmentDate.ToString("dd/MM/yyyy HH:mm")</td>
                                <td>@app.Status</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
        }
        
        <hr>
        <h5>Other ViewBag Data:</h5>
        <p>Patients Count: @(ViewBag.Patients != null ? ((List<QLPhongKham.Models.Patient>)ViewBag.Patients).Count : 0)</p>
        <p>Services Count: @(ViewBag.Services != null ? ((List<QLPhongKham.Models.Service>)ViewBag.Services).Count : 0)</p>
        <p>Medicines Count: @(ViewBag.Medicines != null ? ((List<QLPhongKham.Models.Medicine>)ViewBag.Medicines).Count : 0)</p>
    </div>
</div>

<div class="mt-3">
    <a asp-action="Create" class="btn btn-primary">Go to Create Page</a>
    <a asp-action="Index" class="btn btn-secondary">Back to Index</a>
</div>
